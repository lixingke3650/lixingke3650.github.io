<!DOCTYPE html>
<html lang="jp">
<head>

        <title>20161103_HTTP服务器穿透-OrHttpConnect</title>
        <meta charset="utf-8" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" type="text/css" href="/theme/gumby.css" />
        <link rel="stylesheet" type="text/css" href="/theme/style.css" />
        <link rel="stylesheet" type="text/css" href="/theme/pygment.css" />

        <script src="/theme/js/libs/modernizr-2.6.2.min.js"></script>




</head>

<body id="index" class="home">


    <div class="container">

        <div class="row">

          <header id="banner" class="body">
                  <h1><a href="/">lixingke3650 <strong></strong></a></h1>
          </header><!-- /#banner -->

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>
             
              <ul class="columns">
                <li><a href="/">Home</a></li>

                  <li><a href="/category/ri-ji.html">日记</a></li>
                  <li class="active"><a href="/category/xiang-mu.html">项目</a></li>
                  <li><a href="/category/xue-xi.html">学习</a></li>
                  <li><a href="/category/zheng-li.html">整理</a></li>

              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">


            <header>
              <h2 class="entry-title">
                <a href="/20161103_httpfu-wu-qi-chuan-tou-orhttpconnect.html" rel="bookmark"
                   title="Permalink to 20161103_HTTP服务器穿透-OrHttpConnect">20161103_HTTP服务器穿透-OrHttpConnect</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="2016-11-03T20:00:00+09:00">
                Thu 03 November 2016
              </abbr>
              <address class="vcard author">By 
                <a class="url fn" href="/author/hanbin.html"> Hanbin</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
              <p>因为公司内部防火墙，没法自由的连接外网，只能通过HTTP服务器来访问允许的网站。
好在，HTTP服务器开了CONNECT。自己写了一个工具，利用它配合HTTP服务器的CONNECT就可以穿透防火墙了。</p>
<p>代码托管在：
<a class="reference external" href="https://github.com/lixingke3650/OrHttpConnect">https://github.com/lixingke3650/OrHttpConnect</a></p>
<hr class="docutils" />
<div class="section" id="connect">
<h2>CONNECT</h2>
<p>CONNECT是HTTP协议的一个方法，简单来说就是让HTTP服务器充当一个中间人，用它向外来发起你想要连接。HTTPS也是利用这个方法来建立通信的。
简单的请求头如下：</p>
<div class="highlight"><pre><span></span>CONNECT www.dlut.edu.cn:80 HTTP/1.1
Host: dlut.edu.cn:80
Proxy-Connection: Keep-Alive
Proxy-Authorization: Basic *
Content-Length: 0
</pre></div>
<p>“Proxy-Authorization: Basic <em>”中的“</em>”是登陆HTTP服务器用的验证信息，包含用户名密码，格式是 ： name:password, 并且需要用basic进行编码。
HTTP服务器接收请求并链接到指定的目的地后会返回包含 <strong>“HTTP/1.1 200 Connection Established”</strong> 的应答，否则返回一个 <strong>“Unauthorized”</strong>。</p>
</div>
<div class="section" id="orhttpconnect">
<h2>OrHttpConnect</h2>
<p>OrHttpConnect这个工具可以告诉HTTP服务器帮我连接到哪里，联通以后HTTP服务器就成了一个传话员。
另外，CONNECT本身并没有加密功能，所以HTTP服务器虽然会忠于职守的帮我们转发数据，但有可能也会偷窥我们谈话内容，所以有特殊要求的同学，请使用别的方法来加密通信。</p>
<p>原理很简单，实现方法套用了之前OrTunnel的结构。
通信过程可参考下图：</p>
<img alt="OrHttpConnect 001 not found." src="./resource/img/OrHttpConnect/001.png" />
<p>嗯，就这些吧。
以上。</p>
<p>20161103</p>
<p>越来越懒。。</p>
</div>

            </div><!-- /.entry-content -->
            <div class="comments">
              <h3>Comments</h3>
              <div id="disqus_thread"></div>
              <script type="text/javascript">
                var disqus_identifier = "20161103_httpfu-wu-qi-chuan-tou-orhttpconnect.html";
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://lixingke3650-githubblog.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
              </script>
            </div>


        </div><!-- /.eleven.columns -->

<div class="three columns">


<h4>Categories</h4>
<ul class="blank">
		<li><a href="/category/ri-ji.html">日记</a></li>
		<li><a href="/category/xiang-mu.html">项目</a></li>
		<li><a href="/category/xue-xi.html">学习</a></li>
		<li><a href="/category/zheng-li.html">整理</a></li>
</ul>


<h4>Tags</h4>
	<ul class="blank">
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c369b0>]"><a href="/tag/l2tp.html">L2TP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c369b0>]"><a href="/tag/vpn.html">VPN</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183977e80>]"><a href="/tag/tong-xin-yuan-li.html">通信原理</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183bc4c18>]"><a href="/tag/apache.html">Apache</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b98e48>]"><a href="/tag/utf-8.html">UTF-8</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183977e80>]"><a href="/tag/man-che-si-te-bian-ma.html">曼彻斯特编码</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51823b4fd0>]"><a href="/tag/start-stop-daemon.html">start-stop-daemon</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51838d97f0>, <pelican.contents.Article object at 0x2b5183b98e48>, <pelican.contents.Article object at 0x2b51839d5e10>, <pelican.contents.Article object at 0x2b5183988860>, <pelican.contents.Article object at 0x2b5183b4dd68>]"><a href="/tag/python.html">Python</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c369b0>]"><a href="/tag/ipsec.html">IPSec</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b98e48>]"><a href="/tag/zi-fu-bian-ma.html">字符编码</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839d3b00>, <pelican.contents.Article object at 0x2b5183b11748>]"><a href="/tag/rc4.html">RC4</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c29a58>]"><a href="/tag/sublime.html">Sublime</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b98e48>]"><a href="/tag/bytesstr.html">bytes&amp;str</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183ace320>]"><a href="/tag/apjp.html">APJP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839479e8>]"><a href="/tag/orpsf.html">OrPSF</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839d3b00>]"><a href="/tag/ortunnel.html">OrTunnel</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839f2be0>, <pelican.contents.Article object at 0x2b518390d9b0>, <pelican.contents.Article object at 0x2b5183969400>, <pelican.contents.Article object at 0x2b5183c36fd0>, <pelican.contents.Article object at 0x2b518398db38>, <pelican.contents.Article object at 0x2b5183b6f0b8>]"><a href="/tag/suan-fa.html">算法</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183bc4c18>]"><a href="/tag/centos.html">CentOS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839d3b00>]"><a href="/tag/ssl.html">SSL</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183a87240>]"><a href="/tag/felica.html">Felica</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518240fb38>]"><a href="/tag/shu-ju-ku.html">数据库</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51823b4fd0>]"><a href="/tag/ormonitor.html">OrMonitor</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b4dd68>]"><a href="/tag/web.html">Web</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51838d9080>]"><a href="/tag/liu-mei-ti.html">流媒体</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518240fb38>, <pelican.contents.Article object at 0x2b518390d240>]"><a href="/tag/postgresql.html">PostgreSQL</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518237f278>]"><a href="/tag/markdown.html">Markdown</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518390d240>]"><a href="/tag/mysql.html">MySQL</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b11748>]"><a href="/tag/arc4.html">ARC4</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518392f5f8>]"><a href="/tag/p2p.html">P2P</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183969400>]"><a href="/tag/kuai-su-pai-xu.html">快速排序</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b98e48>]"><a href="/tag/ucs.html">UCS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183ab22b0>]"><a href="/tag/nginx.html">Nginx</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183780978>]"><a href="/tag/gunicorn.html">Gunicorn</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c369b0>]"><a href="/tag/ppp.html">PPP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518390d240>, <pelican.contents.Article object at 0x2b5183bc4c18>]"><a href="/tag/php.html">PHP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518392f5f8>]"><a href="/tag/im.html">IM</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183dc6240>]"><a href="/tag/security.html">Security</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c369b0>]"><a href="/tag/pptp.html">PPTP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518398db38>]"><a href="/tag/ba-huang-hou.html">八皇后</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c36fd0>]"><a href="/tag/ha-fu-man-bian-ma.html">哈夫曼编码</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51838d97f0>, <pelican.contents.Article object at 0x2b5183988860>]"><a href="/tag/orro.html">ORRO</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c29a58>]"><a href="/tag/clexe.html">CL.exe</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183bc4c18>]"><a href="/tag/fms.html">FMS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839e6198>, <pelican.contents.Article object at 0x2b5183a0ff28>]"><a href="/tag/pelican.html">pelican</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518392f5f8>]"><a href="/tag/nei-wang-chuan-tou.html">内网穿透</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518398db38>, <pelican.contents.Article object at 0x2b5183b6f0b8>]"><a href="/tag/hui-su.html">回溯</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c369b0>]"><a href="/tag/vps.html">VPS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b11748>]"><a href="/tag/jia-jie-mi.html">加解密</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b3a940>]"><a href="/tag/http.html">HTTP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839d3b00>]"><a href="/tag/tls.html">TLS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51838d97f0>, <pelican.contents.Article object at 0x2b5183988860>]"><a href="/tag/dai-li.html">代理</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518390d240>]"><a href="/tag/iis.html">IIS</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b6f0b8>]"><a href="/tag/zui-duan-lu-jing.html">最短路径</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183969da0>]"><a href="/tag/mac.html">Mac</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c36fd0>]"><a href="/tag/ha-fu-man-shu.html">哈夫曼树</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b5cfd0>]"><a href="/tag/you.html">YOU</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183c369b0>]"><a href="/tag/openvpn.html">OpenVPN</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183a87240>]"><a href="/tag/nfc.html">NFC</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183ace320>]"><a href="/tag/bae.html">BAE</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b518237f278>]"><a href="/tag/restructuredtext.html">reStructuredText</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51823b4fd0>, <pelican.contents.Article object at 0x2b5183780978>, <pelican.contents.Article object at 0x2b5183ab22b0>, <pelican.contents.Article object at 0x2b5183dc6240>, <pelican.contents.Article object at 0x2b5183bc4c18>]"><a href="/tag/linux.html">Linux</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183969da0>]"><a href="/tag/homebrew.html">Homebrew</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183b98e48>]"><a href="/tag/unicode.html">Unicode</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839d3b00>]"><a href="/tag/tunnel.html">tunnel</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b51839479e8>]"><a href="/tag/sftp.html">SFTP</a></li>
	    <li class="tag-[<pelican.contents.Article object at 0x2b5183a0ff28>]"><a href="/tag/github.html">GitHub</a></li>
</ul>

<nav class="widget">
  <h4>Social</h4>
  <ul class="blank">
    <li><a href="http://github.com/lixingke3650">github</a></li>
  </ul>
</nav>

</div> </div><!-- /.row -->


</section>

       </div><!-- /.row -->
    </div><!-- /.container -->


       <div class="container.nopad bg">

    
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    &copy; Copyright 2016, Hanbin 
                    <br />
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">

                <li><div class="btn primary"><a href="http://github.com/lixingke3650/" target="_blank">Github</a></div></li>




              </ul>
            </div>
          </div>
        </footer>

    </div>


<script type="text/javascript">
    var disqus_shortname = 'lixingke3650-githubblog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
  <script src="/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="/theme/js/libs/gumby.min.js"></script>
  <script src="/theme/js/plugins.js"></script>
</body>
</html>